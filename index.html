<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkillPath</title>

  <!-- Preload background if present -->
  <link rel="preload" as="image" href="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757609577/skillpathnewBackground_xqu8pz.jpg">

  <style>
    :root{
      --bg1:#0f172a; --bg2:#1e293b;
      --panel:#1f2937; --muted:#cbd5e1; --text:#f9fafb;
      --brand:#2563eb; --brand-hover:#1d4ed8;
      --ring:0 0 0 3px rgba(37,99,235,.35);

      /* Eco palette for contact area */
      --eco:#22c55e;
      --eco-600:#16a34a;
      --eco-700:#15803d;
      --eco-ring:0 0 0 3px rgba(34,197,94,.35);
      --eco-panel: #122017;
      --eco-border: rgba(34,197,94,.18);
      --eco-muted: #b7e4c7;
    }
    *{box-sizing:border-box}
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--text);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: all 0.5s ease-in-out;
      position: relative;
    }
    body.login-bg {
      background-image: url("https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757609577/skillpathnewBackground_xqu8pz.jpg");
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
      background-blend-mode: overlay;
      background-attachment: fixed;
    }
    .card {
      background: var(--panel);
      padding: 30px;
      border-radius: 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      width: 350px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.06);
    }
    #loginPage { position: absolute; right: 48px; left: auto; top: 50%; transform: translateY(-50%); width: 360px; }
    #skillsPage, #detailPage, #contactPage {
      position: relative; margin: 0 auto; max-width: 900px; width: min(900px, 92vw); text-align: left;
    }
    h1,h2{ margin:0 0 16px }
    input, select, textarea{
      width: 100%; padding: 12px 14px; margin: 8px 0;
      border-radius: 10px; border: 1px solid #374151;
      background: rgba(17,24,39,0.9); color: var(--text); outline: none;
      box-shadow: none;
      transition: box-shadow .2s ease, transform .2s ease, border-color .2s ease;
    }
    input:focus, select:focus, textarea:focus{ box-shadow: var(--ring) }
    textarea{ resize: vertical }
    input::placeholder, textarea::placeholder { color: rgba(249,250,251,0.65); }

    button {
      padding: 12px 14px; margin: 8px 0; border: none; border-radius: 10px;
      background: var(--brand); color: #fff; font-weight: 600; cursor: pointer;
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
    }
    button:hover { background: var(--brand-hover); }
    .btn-secondary{ background:#374151 }
    .btn-secondary:hover{ background:#303746 }
    .actions{ display:flex; gap:10px; flex-wrap:wrap }
    .link { margin-top: 10px; display:inline-block; color: #93c5fd; cursor: pointer; text-decoration: none; transition: opacity .2s ease; }
    .link:hover{ text-decoration: underline }
    .hidden { display: none; }
    .info { margin-top: 20px; text-align: left; }
    .info img { width: 60px; margin-bottom: 10px; }
    ul { padding-left: 20px; }
    .small { font-size: 0.9rem; color: var(--muted); }
    .error { color: #ffb4b4; margin-top: 6px; }
    .success { color: #b6f6c1; margin-top: 6px; }
    .badge { display:inline-block; padding:6px 10px; border-radius:999px; background:#374151; color:#cbd5e1; font-size:0.85rem; margin-left:8px; }

    /* Roadmap images */
    .skill-roadmap {
      width: 100%; max-width: 1400px; max-height: 900px; height: auto;
      margin-top: 20px; margin-bottom: 12px; border-radius: 8px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.45); display: block; object-fit: contain;
    }
    .roadmap-block {
      background: rgba(255,255,255,0.02); padding: 12px; border-radius: 12px; margin-top: 8px;
    }
    .row { display:flex; gap:14px; align-items:center; flex-wrap:wrap; justify-content:space-between; }

    @media (max-width:1200px){ .skill-roadmap { max-width: 1000px; max-height: 800px; } }
    @media (max-width:900px){
      #loginPage { position: relative; right: auto; left: auto; top: auto; transform: none; width: 92%; margin: 16px auto; }
      #skillsPage { margin: 16px auto; }
      .skill-roadmap { max-width: 100%; max-height: 800px; }
    }
    @media (max-width:420px){ .card { width: 92%; padding: 20px; } .skill-roadmap { max-height: 650px; } }

    /* Rainbow animated border for draggable roadmap blocks */
    @property --spin-angle{ syntax:"<angle>"; inherits:false; initial-value:0deg; }
    .dragbox{
      position: relative; border-radius: 12px; border: 2px solid transparent;
      background:
        linear-gradient(#1f2937, #1f2937) padding-box,
        conic-gradient(from var(--spin-angle),
          #ff6b6b, #ffd166, #f6ff6b, #6bffb0, #6be3ff, #a78bfa, #ff6b6b
        ) border-box;
      animation: spinGradient 8s linear infinite;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .dragbox.is-dragging{ transform: scale(1.01); box-shadow: 0 10px 30px rgba(0,0,0,0.45), 0 0 0 6px rgba(167,139,250,0.25); cursor: grabbing; }
    @keyframes spinGradient{ to{ --spin-angle:360deg } }

    /* ---------- Blink animation (only for specific buttons) ---------- */
    @keyframes blinkPulse {
      0%   { box-shadow: 0 0 0 0 rgba(99,102,241,.65); transform: translateZ(0); }
      50%  { box-shadow: 0 0 0 6px rgba(99,102,241,.18), 0 0 20px 4px rgba(168,85,247,.25); }
      100% { box-shadow: 0 0 0 0 rgba(99,102,241,.0); }
    }
    #loginBtn:hover, #loginBtn:focus-visible,
    #skipBtn:hover, #skipBtn:focus-visible,
    #showSignupBtn:hover, #showSignupBtn:focus-visible {
      animation: blinkPulse .9s ease-in-out infinite;
    }

    /* ------------------ Contact page: professional + eco-friendly ------------------ */
    #contactPage.card{
      max-width: 820px; width: min(820px, 92vw); text-align:left;
      background: linear-gradient(180deg, var(--eco-panel), rgba(18,32,23,.95));
      border: 1px solid var(--eco-border);
      box-shadow: 0 12px 40px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.03);
    }
    .contact-hero{
      position: relative;
      padding: 16px 18px;
      border-radius: 12px;
      background:
        radial-gradient(1200px 200px at 50% -80%, rgba(34,197,94,.18), transparent 60%),
        linear-gradient(180deg, rgba(21,128,61,.55), rgba(21,128,61,.25));
      border: 1px solid rgba(34,197,94,.22);
      display:flex; align-items:center; gap:12px; justify-content:space-between;
      margin-bottom: 14px;
    }
    .contact-hero h1{ margin:0 }
    .eco-pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px; font-size:.9rem;
      background: rgba(34,197,94,.12); color: var(--eco-muted);
      border:1px solid rgba(34,197,94,.28);
    }
    .leaf{ font-size: 1.1rem }

    .contact-meta{
      display:flex; gap:12px; flex-wrap:wrap; margin: 8px 0 16px;
    }
    .meta-pill{
      padding:10px 12px; background:rgba(10,24,16,.9);
      border:1px solid rgba(34,197,94,.22);
      border-radius:10px; color:#cfead7; font-size:.9rem;
    }

    .contact-grid{
      display:grid; grid-template-columns: 1fr 1fr; gap:14px; margin-top:10px;
    }
    @media (max-width: 640px){ .contact-grid{ grid-template-columns: 1fr; } }

    /* Inputs in contact page get eco focus */
    #contactPage input, #contactPage textarea{
      background: rgba(5,12,9,.75);
      border: 1px solid rgba(34,197,94,.18);
    }
    #contactPage input:focus, #contactPage textarea:focus{
      box-shadow: var(--eco-ring);
      border-color: rgba(34,197,94,.45);
    }

    .btn-eco{
      background: linear-gradient(180deg, var(--eco), var(--eco-600));
      border: 1px solid rgba(34,197,94,.35);
    }
    .btn-eco:hover{ background: linear-gradient(180deg, var(--eco-600), var(--eco-700)); }

    .btn-ghost{
      background: rgba(12,22,16,.65);
      border: 1px solid rgba(34,197,94,.22);
      color: #d1fae5;
    }
    .btn-ghost:hover{ background: rgba(12,22,16,.85); }

    .eco-note{
      display:flex; align-items:center; gap:8px; color:#cfead7; margin-top:10px;
      opacity:.9
    }
    .eco-divider{
      height:1px; width:100%;
      background: linear-gradient(90deg, transparent, rgba(34,197,94,.45), transparent);
      margin: 8px 0 2px;
    }

    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    /* ====== Small refinements for the new login layout ====== */
    #loginPage.card {
      width: 380px;
      padding: 28px 26px;
      backdrop-filter: blur(6px) saturate(110%);
      -webkit-backdrop-filter: blur(6px) saturate(110%);
    }
    #loginPage label.small { color: #cbd5e1; font-weight: 600; }
    #loginPage .error { margin-top: 8px; font-size: 0.9rem; }
    #loginPage input { height: 44px; border-radius: 12px; }
    #togglePwd { padding:6px 10px; font-weight:500; line-height:1; }

    /* ====== NEW: Adaptive dark theme for Skills page ====== */
    #skillsPage.card {
      background: linear-gradient(180deg, #1e293b, #0f172a);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 14px;
      padding: 28px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.35);
      color: #f9fafb;
    }
    #skillsPage h1 {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 12px;
      color: #f9fafb;
    }
    #skillsPage select {
      background: #0f172a;
      border: 1px solid #374151;
      color: #f9fafb;
    }
    #skillsPage select:focus {
      box-shadow: 0 0 0 3px rgba(37,99,235,.35);
      border-color: #2563eb;
    }
    #skillsPage button {
      background: #2563eb;
      color: #fff;
      font-weight: 600;
    }
    #skillsPage button:hover {
      background: #1d4ed8;
    }
  </style>
</head>
<body>

  <!-- Login / Signup Section (MERGED, professional) -->
  <div id="loginPage" class="card">
    <h2 style="margin-bottom:6px;">SkillPath Portal</h2>
    <p class="small" style="margin-top:-4px; opacity:.85">Sign in to your account</p>

    <form id="loginForm" onsubmit="return false" style="margin-top:10px; text-align:left;">
      <label for="usernameOrEmail" class="small">Username or Email</label>
      <input type="text" id="usernameOrEmail" placeholder="you@example.com" autocomplete="username" aria-label="Username or Email" required>

      <label for="password" class="small" style="margin-top:6px; display:flex; justify-content:space-between; align-items:center;">
        <span>Password</span>
        <button type="button" id="togglePwd" class="btn-secondary">Show</button>
      </label>
      <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" aria-label="Password" required>

      <div style="display:flex; justify-content:space-between; align-items:center; margin:6px 0 2px;">
        <label class="small" style="display:flex; gap:8px; align-items:center;">
          <input id="rememberMe" type="checkbox" style="width:16px; height:16px; accent-color:#2563eb;">
          Remember me
        </label>
        <a class="link" href="#" id="forgotLink">Forgot password?</a>
      </div>

      <button id="loginBtn" style="width:100%; margin-top:12px;">Login</button>

      <div class="actions" style="margin-top:8px;">
        <button id="showSignupBtn" class="btn-secondary" style="flex:1">Sign Up</button>
        <button id="skipBtn" class="btn-secondary" style="flex:1">Skip Login</button>
      </div>

      <div id="loginMsg" class="error" role="alert" aria-live="polite"></div>
    </form>

    <div style="margin-top:8px">
      <a class="link" href="#" id="openContactLink">Contact</a>
      <span class="small" style="opacity:.6">‚Ä¢ Need help or want to collaborate?</span>
    </div>

    <!-- Signup form (hidden by default) -->
    <div id="signupArea" class="hidden" style="margin-top:14px; text-align:left;">
      <h3 style="margin:0 0 8px">Create account</h3>
      <input type="text" id="su_username" placeholder="Choose a username (no spaces)" aria-label="Choose a username">
      <input type="email" id="su_email" placeholder="Email (used to login securely)" aria-label="Email">
      <input type="password" id="su_password" placeholder="Password (min 6 chars)" aria-label="Password">
      <div class="actions">
        <button id="createAccountBtn">Create Account</button>
        <button type="button" class="btn-secondary" onclick="toggleSignup()">Cancel</button>
      </div>
      <div id="signupMsg" class="small"></div>
    </div>
  </div>

  <!-- Page 1: Skills Select -->
  <div id="skillsPage" class="card hidden">
    <h1>Choose Your Skill</h1>
    <div style="text-align:left; margin-bottom:10px;">
      <strong id="welcomeUser">Hello</strong>
      <span id="userType" class="small" style="display:block;"></span>
      <span id="tempBadge" class="badge hidden">Temporary account ‚Äî finalize signup</span>
    </div>

    <select id="skillSelect" onchange="showSkill()" aria-label="Select a skill">
      <option value="">-- Select a Skill --</option>
      <option value="cpp">üíª C++</option>
      <option value="html">üåê HTML</option>
      <option value="python">üêç Python</option>
      <option value="java">‚òï Java</option>
      <option value="php">üêò PHP</option>
      <option value="r">üìä R</option>
    </select>

    <p class="small">Pick a skill to view its details on a separate page.</p>

    <button onclick="backToLogin()">‚¨Ö Back</button>
  </div>

  <!-- Page 2: Skill Detail -->
  <div id="detailPage" class="card hidden">
    <div class="row">
      <h1 id="detailTitle" style="margin:0;">Skill</h1>
      <!-- Back buttons appear after each roadmap image -->
    </div>
    <div id="detailInfo" class="info"></div>
  </div>

  <!-- Page 3: Contact (PRO + ECO) -->
  <div id="contactPage" class="card hidden" role="region" aria-labelledby="contactHeading">
    <div class="contact-hero">
      <h1 id="contactHeading" style="margin:0">Contact</h1>
      <span class="eco-pill"><span class="leaf">üåø</span>Carbon-aware & paperless</span>
    </div>

    <div class="small" style="margin-top:-4px">
      We‚Äôd love to hear from you. Tell us a bit about your request and we‚Äôll get back promptly.
    </div>

    <div class="eco-divider"></div>

    <!-- Contact meta (static info) -->
    <div class="contact-meta" aria-label="Contact information">
      <span class="meta-pill">üìß Email: <strong style="margin-left:6px">s.harish143ff@gmail.com</strong></span>
      <span class="meta-pill">‚òéÔ∏è Phone: <strong id="contactPhone" style="margin-left:6px">+91 9XXXXXXXXX</strong></span>
      <span class="meta-pill">‚è∞ Hours: <strong style="margin-left:6px">Mon‚ÄìSat, 9am‚Äì6pm IST</strong></span>
    </div>

    <!-- Professional form -->
    <form id="contactForm" onsubmit="return submitContact(event)" novalidate>
      <div class="contact-grid">
        <div>
          <label for="c_email" class="small">Your email</label>
          <input id="c_email" type="email" placeholder="you@example.com" required aria-required="true">
        </div>
        <div>
          <label for="c_name" class="small">Your name</label>
          <input id="c_name" type="text" placeholder="Full name" required aria-required="true">
        </div>
        <div>
          <label for="c_phone" class="small">Your phone number</label>
          <input id="c_phone" type="tel" placeholder="+91 9XXXXXXXXX" pattern="^[0-9+() -]{7,}$" required aria-required="true">
        </div>
        <div>
          <label for="c_subject" class="small">Subject</label>
          <input id="c_subject" type="text" placeholder="e.g., Collaboration / Support" required aria-required="true">
        </div>
      </div>

      <div style="margin-top:6px">
        <label for="c_message" class="small">Message <span class="small" style="opacity:.7">(optional)</span></label>
        <textarea id="c_message" rows="5" placeholder="Briefly describe your request‚Ä¶"></textarea>
      </div>

      <div class="small eco-note">
        <span class="leaf">üå±</span>
        We prefer concise, single-threaded replies to reduce back-and-forth and keep our footprint low.
      </div>

      <div class="actions" style="margin-top:12px">
        <button type="submit" class="btn-eco">Send Message</button>
        <button type="button" class="btn-ghost" onclick="backFromContact()">Cancel</button>
      </div>

      <div class="small" style="opacity:.85; margin-top:6px; color:#cfead7">
        Submitting opens your email app with a pre-filled message. No data is stored on our servers.
      </div>
    </form>
  </div>

  <!-- Firebase SDKs (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-functions-compat.js"></script>

  <script>
    /* ---------- Firebase (placeholder; optional) ---------- */
    const firebaseConfig = { apiKey:"PASTE_YOUR_API_KEY", authDomain:"YOUR_PROJECT.firebaseapp.com", projectId:"YOUR_PROJECT_ID" };
    const FIREBASE_CONFIG_SET = firebaseConfig && firebaseConfig.apiKey && !firebaseConfig.apiKey.includes('PASTE_YOUR');
    let auth=null, db=null, functions=null;
    if (FIREBASE_CONFIG_SET) {
      firebase.initializeApp(firebaseConfig);
      auth = firebase.auth(); db = firebase.firestore(); functions = firebase.functions();
      firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL).catch(err => console.warn('Failed to set persistence:', err));
    }

    /* ---------- Skill Data (image src values untouched) ---------- */
    const skillData = {
      cpp: {
        title: "C++ Programming",
        description:
          "Role in CS: C++ powers operating systems, game engines, and high-performance applications. " +
          "Important: learn manual memory management, RAII (Resource Acquisition Is Initialization), and modern C++ (C++11/14/17/20) practices to write safe and efficient code. " +
          "Use cases include embedded systems, real-time applications, and performance-critical modules.",
        benefits: [
          "High performance and efficiency",
          "Supports object-oriented programming (OOP)",
          "Rich Standard Template Library (STL)",
          "Widely used in system-level programming",
          "Great for competitive programming and problem-solving"
        ],
        img: "https://isocpp.org/assets/images/cpp_logo.png",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <strong>BASICS</strong>
            <ul>
              <li>Data types, variables, I/O</li>
              <li>Functions</li>
              <li>Control structures (if/else, loops)</li>
            </ul>
            <strong>CONTROL STRUCTURES</strong>
            <ul>
              <li>If, switch, for, while</li>
            </ul>
            <strong>DATA TYPES</strong>
            <ul>
              <li>Primitive types, enums, typedefs</li>
            </ul>
            <strong>FUNCTIONS</strong>
            <ul>
              <li>Function overloading, default args, inline</li>
            </ul>
            <strong>STRINGS</strong>
            <ul>
              <li>std::string, c-strings, common operations</li>
            </ul>
            <strong>ARRAYS</strong>
            <ul>
              <li>Static arrays, std::vector, memory layout</li>
            </ul>
            <strong>POINTERS</strong>
            <ul>
              <li>Pointer basics, references, dynamic memory, smart pointers</li>
            </ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610936/c_qea4gx.jpg" alt="C++ Roadmap" class="skill-roadmap">
        `
      },
      html: {
        title: "HTML",
        description:
          "Role in CS: HTML structures content for the web and is the foundation of front-end development. " +
          "Important: focus on semantic HTML, accessibility (a11y), and responsive design to build inclusive and maintainable web pages. Combine with CSS and JavaScript for interactive experiences.",
        benefits: [
          "Easy to learn and implement",
          "Forms the foundation of every website",
          "Works with CSS and JavaScript for full web apps",
          "Cross-platform compatibility",
          "Supported by all browsers and devices"
        ],
        img: "https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <h4>HTML Learning Roadmap</h4>
            <strong>Level 1 - Basics (Foundation)</strong>
            <ul>
              <li>HTML document structure</li><li>Common tags, text formatting, lists</li><li>Links, images, basic accessibility</li>
            </ul>
            <strong>Level 2 - Semantics & Forms</strong>
            <ul>
              <li>Semantic elements, grouping content</li><li>Tables</li><li>Forms & inputs, attributes</li>
            </ul>
            <strong>Level 3 - Workflow</strong>
            <ul>
              <li>HTML + CSS + JS</li><li>Data-attributes</li><li>A11y with dynamic content</li>
            </ul>
            <strong>Level 4 - Production</strong>
            <ul>
              <li>Responsive patterns</li><li>PWA basics</li><li>Performance & a11y audits</li>
            </ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610946/HTML_Learning_Roadmap_Guide_qlke9r.png" alt="HTML Roadmap" class="skill-roadmap">
        `
      },
      php: {
        title: "PHP",
        description:
          "Role in CS: PHP is a server-side scripting language ideal for building dynamic web backends. " +
          "Important: learn secure handling of user input, prepared statements, and modern PHP practices with Composer and frameworks (Laravel) for scalable apps.",
        benefits: [
          "Great for backend web development",
          "Easy integration with databases",
          "Open source with large community",
          "Fast deployment for web apps",
          "Powering platforms like WordPress and Facebook"
        ],
        img: "https://upload.wikimedia.org/wikipedia/commons/2/27/PHP-logo.svg",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <h4>PHP Roadmap (5 Levels)</h4>
            <strong>Basics</strong><ul><li>HTML/CSS/JS</li><li>Variables & functions</li><li>Local server (XAMPP/WAMP/LAMP)</li></ul>
            <strong>Core PHP</strong><ul><li>Control structures</li><li>Forms</li><li>Files</li><li>Sessions & cookies</li></ul>
            <strong>DB</strong><ul><li>MySQL CRUD</li><li>PDO & prepared statements</li></ul>
            <strong>Intermediate</strong><ul><li>Exceptions</li><li>Uploads, email</li><li>JSON/XML/REST</li><li>OOP, security</li></ul>
            <strong>Advanced</strong><ul><li>Composer</li><li>MVC</li><li>Auth</li><li>Laravel</li></ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610965/php_jxl4aj.jpg" alt="PHP Roadmap" class="skill-roadmap">
        `
      },
      r: {
        title: "R Programming",
        description:
          "Role in CS: R excels at statistical analysis, data visualization, and exploratory data science. " +
          "Important: become familiar with ggplot2, dplyr and R Markdown for reproducible reporting.",
        benefits: [
          "Advanced statistical computing capabilities",
          "Rich data visualization tools",
          "Strong in academia and research",
          "Integrates with big data frameworks",
          "Large set of packages for analytics"
        ],
        img: "https://upload.wikimedia.org/wikipedia/commons/1/1b/R_logo.svg",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <h4>R Language Learning Roadmap</h4>
            <strong>Basics</strong><ul><li>Install R & RStudio</li><li>Syntax & data types</li><li>Vectors, lists, matrices, data frames</li></ul>
            <strong>Data & Viz</strong><ul><li>Import/export</li><li>Cleaning</li><li>dplyr & tidyr</li><li>ggplot2</li></ul>
            <strong>Statistics</strong><ul><li>Descriptive stats</li><li>Distributions</li><li>Hypothesis testing</li></ul>
            <strong>ML</strong><ul><li>Supervised/Unsupervised</li><li>Time series</li><li>Evaluation</li></ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610990/r_niz52d.jpg" alt="R Roadmap" class="skill-roadmap">
        `
      },
      python: {
        title: "Python",
        description:
          "Role in CS: Python is essential for AI, data science, scripting and rapid application development. " +
          "Important: master ecosystem libraries (pandas, numpy, scikit-learn, tensorflow) and best practices like virtual environments and testing.",
        benefits: [
          "Readable and beginner-friendly syntax",
          "Huge standard library and community support",
          "Excellent for AI, ML, and data science",
          "Cross-platform and versatile",
          "Strong integration with modern frameworks"
        ],
        img: "https://upload.wikimedia.org/wikipedia/commons/c/c3/Python-logo-notext.svg",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <h4>Python Learning Roadmap</h4>
            <strong>Basics</strong><ul><li>Install Python & IDE</li><li>Syntax & indentation</li><li>Variables & types</li></ul>
            <strong>Core</strong><ul><li>Functions</li><li>Lists/tuples/sets/dicts</li><li>Files & exceptions</li><li>Modules & pip</li></ul>
            <strong>Intermediate</strong><ul><li>Comprehensions</li><li>Iterators & generators</li><li>OOP</li><li>Decorators</li></ul>
            <strong>Advanced</strong><ul><li>venv</li><li>Threads/processes</li><li>Context managers</li><li>Type hints</li></ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610984/python_ojnuwh.jpg" alt="Python Roadmap" class="skill-roadmap">
        `
      },
      java: {
        title: "Java",
        description:
          "Role in CS: Java powers large enterprise systems, Android apps and cross-platform server software. " +
          "Important: learn JVM internals, memory model, concurrency primitives and Spring for production-grade applications.",
        benefits: [
          "Platform-independent with JVM",
          "Robust and secure programming model",
          "Massive ecosystem and libraries",
          "Strong OOP principles",
          "Backbone of Android development"
        ],
        img: "https://upload.wikimedia.org/wikipedia/en/3/30/Java_programming_language_logo.svg",
        roadmap: `
          <div class="roadmap-block dragbox" draggable="true">
            <h4>Java Learning Roadmap</h4>
            <strong>Basics</strong><ul><li>Setup & syntax</li><li>I/O, operators, control flow</li></ul>
            <strong>Core</strong><ul><li>OOP (classes, inheritance, interfaces)</li><li>Collections</li><li>Exceptions</li></ul>
            <strong>Tools</strong><ul><li>Maven/Gradle</li><li>JUnit & logging</li></ul>
            <strong>Web</strong><ul><li>Servlets/JSP, Spring MVC</li></ul>
            <strong>Advanced</strong><ul><li>REST, microservices</li><li>Cloud (AWS)</li></ul>
          </div>
          <img src="https://res.cloudinary.com/dxwfxgn5z/image/upload/v1757610949/java_vhyqwg.jpg" alt="Java Roadmap" class="skill-roadmap">
        `
      }
    };

    /* ---------- Page switching helpers ---------- */
    function showSelectPage(){
      document.getElementById('skillsPage').classList.remove('hidden');
      document.getElementById('detailPage').classList.add('hidden');
      document.getElementById('contactPage').classList.add('hidden');
      const skillsEl = document.getElementById('skillsPage');
      skillsEl.style.maxWidth = '900px'; skillsEl.style.width = 'min(900px, 92vw)'; skillsEl.style.padding = '';
      document.body.style.overflowY = 'auto';
    }
    function showDetailPage(){
      document.getElementById('skillsPage').classList.add('hidden');
      document.getElementById('detailPage').classList.remove('hidden');
      document.getElementById('contactPage').classList.add('hidden');
      const detailEl = document.getElementById('detailPage');
      detailEl.style.maxWidth = '1400px'; detailEl.style.width = '100%'; detailEl.style.padding = '36px';
      document.body.style.overflowY = 'auto';
    }
    function showContactPage(){
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('skillsPage').classList.add('hidden');
      document.getElementById('detailPage').classList.add('hidden');
      document.getElementById('contactPage').classList.remove('hidden');
      document.body.classList.remove('login-bg');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    function backFromContact(){
      document.getElementById('contactPage').classList.add('hidden');
      document.getElementById('loginPage').classList.remove('hidden');
      document.body.classList.add('login-bg');
    }
    function backToSkills(){
      const info = document.getElementById('detailInfo');
      if (info) info.innerHTML = '';
      showSelectPage();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    window.backToSkills = backToSkills;

    /* ---------- Inject Back button after each roadmap image ---------- */
    function injectBackButtons(container){
      const imgs = container.querySelectorAll('.skill-roadmap');
      if (!imgs.length) return;
      imgs.forEach(img => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.textContent = '‚¨Ö Back to list';
        btn.addEventListener('click', backToSkills);
        img.insertAdjacentElement('afterend', btn);
      });
    }

    /* ---------- Make roadmap blocks draggable with animated border ---------- */
    function enhanceDragboxes(root){
      const blocks = root.querySelectorAll('.roadmap-block');
      blocks.forEach(box => {
        if (!box.classList.contains('dragbox')) box.classList.add('dragbox');
        box.setAttribute('draggable', 'true');
        box.addEventListener('dragstart', () => box.classList.add('is-dragging'));
        box.addEventListener('dragend',   () => box.classList.remove('is-dragging'));
      });
    }

    /* ---------- Select ‚Üí Detail ---------- */
    function showSkill(){
      const val = document.getElementById("skillSelect").value;
      if (!val) return;

      const data = skillData[val];
      const titleEl = document.getElementById('detailTitle');
      const infoEl  = document.getElementById('detailInfo');

      titleEl.textContent = data.title;

      const html = `
        <div style="display:flex; align-items:center; gap:12px;">
          <img src="${data.img}" alt="${data.title}" style="width:60px; height:60px; object-fit:contain;">
          <div>
            <h2 style="margin:0;">${data.title}</h2>
            <div class="small">${data.description}</div>
          </div>
        </div>

        <div style="margin-top:12px;">
          <h3 style="margin-bottom:6px;">Benefits</h3>
          <ul>${data.benefits.map(b => `<li>${b}</li>`).join('')}</ul>
        </div>

        <h3 style="margin-top:14px;">ROAD MAP ‚Äî ${data.title}</h3>
        <div id="roadmapArea">${data.roadmap || '<div class="small roadmap-block dragbox" draggable="true">Roadmap content coming soon.</div>'}</div>
      `;
      infoEl.innerHTML = html;

      const area = document.getElementById('roadmapArea');
      enhanceDragboxes(area);

      area.querySelectorAll('.skill-roadmap').forEach(img => {
        img.style.display = 'block'; img.style.width = '100%'; img.style.maxWidth = '1400px';
        img.style.height = 'auto'; img.style.objectFit = 'contain';
      });
      injectBackButtons(area);

      showDetailPage();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    window.showSkill = showSkill;

    /* ---------- Auth & Login UI ---------- */
    const loginBtn = document.getElementById('loginBtn');
    const skipBtn = document.getElementById('skipBtn');
    const showSignupBtn = document.getElementById('showSignupBtn');
    const createAccountBtn = document.getElementById('createAccountBtn');
    const openContactLink = document.getElementById('openContactLink');

    function toggleSignup(){ document.getElementById('signupArea').classList.toggle('hidden'); }
    showSignupBtn.addEventListener('click', toggleSignup);

    function showLoginMsg(text, isError=true){
      const el = document.getElementById('loginMsg');
      el.textContent = text; el.className = isError ? 'error' : 'success';
    }

    function setWelcome(name, isGuest){
      document.getElementById('welcomeUser').textContent = 'Hello, ' + name;
      document.getElementById('userType').textContent = isGuest ? 'You are using the app as Guest.' : 'Logged in user';
      const badge = document.getElementById('tempBadge');
      const isTemp = sessionStorage.getItem('isTempUser') === 'true';
      badge.classList.toggle('hidden', !isTemp);
    }

    function resetSkillSelection(){
      const skillSelect = document.getElementById('skillSelect');
      if (skillSelect) skillSelect.selectedIndex = 0;
      try { localStorage.removeItem('skillpath_lastSkill'); } catch(e){}
      try { sessionStorage.removeItem('lastSkillSelection'); } catch(e){}
    }

    async function handleLogin(){
      const identifier = document.getElementById('usernameOrEmail').value.trim();
      const password   = document.getElementById('password').value;
      document.getElementById('loginMsg').textContent = '';

      if (!identifier || !password) return showLoginMsg('Enter username/email and password.');

      // Simple local admin
      if (identifier.toLowerCase() === 'skillpath' && password === 'skills'){
        sessionStorage.setItem('username', 'Admin');
        sessionStorage.setItem('isGuest', 'false');
        sessionStorage.setItem('isTempUser', 'false');
        setWelcome('Admin', false);
        resetSkillSelection();
        goToSkills();
        return;
      }

      if (FIREBASE_CONFIG_SET && auth && db){
        try{
          let emailToUse = identifier;
          if (!identifier.includes('@')){
            const unameDoc = await db.collection('usernames').doc(identifier.toLowerCase()).get();
            if (!unameDoc.exists) return showLoginMsg('Username not found.');
            emailToUse = unameDoc.data().email;
          }
          await auth.signInWithEmailAndPassword(emailToUse, password);

          let username = identifier;
          if (identifier.includes('@')){
            const q = await db.collection('users').where('email', '==', emailToUse).limit(1).get();
            if (!q.empty) username = q.docs[0].data().username || emailToUse;
          }

          sessionStorage.setItem('userUID', auth.currentUser.uid);
          sessionStorage.setItem('username', username);
          sessionStorage.setItem('isGuest', 'false');
          sessionStorage.setItem('isTempUser', 'false');
          setWelcome(username, false);
          resetSkillSelection();
          goToSkills();
          return;
        } catch(err){
          console.error(err);
          return showLoginMsg('Login failed: ' + (err.message || err));
        }
      }

      // Local fallback
      try{
        const raw = localStorage.getItem('local_fallback_user');
        if (!raw) return showLoginMsg('No local account available.');
        const u = JSON.parse(raw);
        if ((identifier.toLowerCase() === u.username.toLowerCase() || identifier === u.email) && password === u.password){
          sessionStorage.setItem('username', u.username);
          sessionStorage.setItem('isGuest', 'false');
          sessionStorage.setItem('isTempUser', 'false');
          setWelcome(u.username, false);
          resetSkillSelection();
          goToSkills();
        } else {
          showLoginMsg('Local login failed. Use username "skillpath" and password "skills".');
        }
      } catch(e){
        console.error('Local fallback login error', e);
        showLoginMsg('Login error.');
      }
    }
    loginBtn.addEventListener('click', handleLogin);

    function handleCreateAccount(){
      const su_username = document.getElementById('su_username').value.trim();
      const su_email    = document.getElementById('su_email').value.trim();
      const su_password = document.getElementById('su_password').value;

      const signupMsg = document.getElementById('signupMsg');
      signupMsg.textContent = '';

      if (!su_username) return signupMsg.textContent = 'Enter a username.';
      if (!su_email)    return signupMsg.textContent = 'Enter an email.';
      if (!su_password || su_password.length < 6) return signupMsg.textContent = 'Password must be at least 6 characters.';

      const temp = { username: su_username, email: su_email, createdAt: Date.now(), status: 'temporary' };
      try{
        sessionStorage.setItem('temp_signup_user', JSON.stringify(temp));
        sessionStorage.setItem('username', su_username);
        sessionStorage.setItem('isGuest', 'false');
        sessionStorage.setItem('isTempUser', 'true');
        setWelcome(su_username, false);
        resetSkillSelection();
        goToSkills();
      } catch(e){
        console.warn('Could not save temporary signup:', e);
        signupMsg.textContent = 'Failed to create temporary account.';
      }
    }
    createAccountBtn.addEventListener('click', handleCreateAccount);

    function handleSkip(){
      sessionStorage.setItem('isGuest', 'true');
      sessionStorage.removeItem('userUID');
      sessionStorage.setItem('username', 'Guest');
      sessionStorage.setItem('isTempUser', 'false');
      setWelcome('Guest', true);
      resetSkillSelection();
      goToSkills();
    }
    skipBtn.addEventListener('click', handleSkip);

    function goToSkills(){
      document.getElementById("loginPage").classList.add("hidden");
      showSelectPage();
      document.body.classList.remove('login-bg');
    }
    function backToLogin(){
      document.getElementById("skillsPage").classList.add("hidden");
      document.getElementById("detailPage").classList.add("hidden");
      document.getElementById("contactPage").classList.add("hidden");
      document.getElementById("loginPage").classList.remove("hidden");
      document.getElementById("loginMsg").textContent = "";
      document.body.classList.add('login-bg');
    }
    window.backToLogin = backToLogin;

    // Contact link on login page
    openContactLink.addEventListener('click', (e)=>{ e.preventDefault(); showContactPage(); });

    // Contact form -> open mail client (sends to your email)
    function submitContact(ev){
      ev.preventDefault();
      const email   = encodeURIComponent(document.getElementById('c_email').value.trim());
      const name    = encodeURIComponent(document.getElementById('c_name').value.trim());
      const phone   = encodeURIComponent(document.getElementById('c_phone').value.trim());
      const subject = encodeURIComponent(document.getElementById('c_subject').value.trim());
      const message = encodeURIComponent((document.getElementById('c_message').value || '').trim());

      const to = 's.harish143ff@gmail.com';
      const body = `Name: ${name}%0D%0APhone: ${phone}%0D%0AEmail: ${email}%0D%0A%0D%0A${message}`;
      window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
      return false;
    }

    /* ===== Login UX helpers: password toggle + gate Login button ===== */
    const pwd = document.getElementById('password');
    const togglePwd = document.getElementById('togglePwd');
    if (togglePwd) {
      togglePwd.addEventListener('click', () => {
        const isText = pwd.type === 'text';
        pwd.type = isText ? 'password' : 'text';
        togglePwd.textContent = isText ? 'Show' : 'Hide';
        pwd.focus();
      });
    }
    const loginForm = document.getElementById('loginForm');
    const loginBtnEl = document.getElementById('loginBtn');
    function gateLogin() {
      const hasId = document.getElementById('usernameOrEmail').value.trim().length > 0;
      const hasPw = pwd.value.trim().length > 0;
      loginBtnEl.disabled = !(hasId && hasPw);
      loginBtnEl.style.opacity = loginBtnEl.disabled ? .6 : 1;
    }
    ['input','change'].forEach(ev=>{
      document.getElementById('usernameOrEmail').addEventListener(ev, gateLogin);
      pwd.addEventListener(ev, gateLogin);
    });
    gateLogin();

    // Remember me (stores username only)
    const remember = document.getElementById('rememberMe');
    if (remember && localStorage.getItem('sp_remember_user')) {
      document.getElementById('usernameOrEmail').value = localStorage.getItem('sp_remember_user');
      remember.checked = true; gateLogin();
    }
    if (remember) {
      remember.addEventListener('change', () => {
        const v = document.getElementById('usernameOrEmail').value.trim();
        if (remember.checked && v) localStorage.setItem('sp_remember_user', v);
        else localStorage.removeItem('sp_remember_user');
      });
    }

    /* -------- Boot -------- */
    window.addEventListener('load', () => {
      // local fallback account for demo
      try{
        const fallbackUser = { username:'skillpath', password:'skills', email:'skillpath.local@example.com', createdAt:Date.now() };
        localStorage.setItem('local_fallback_user', JSON.stringify(fallbackUser));
        const namesKey = 'local_usernames';
        const existing = localStorage.getItem(namesKey);
        let map = existing ? JSON.parse(existing) : {};
        map['skillpath'] = fallbackUser.email;
        localStorage.setItem(namesKey, JSON.stringify(map));
      }catch(e){}

      // keep login background on first screen
      const loginEl = document.getElementById('loginPage');
      const skillsEl = document.getElementById('skillsPage');
      if (loginEl && !loginEl.classList.contains('hidden') && skillsEl && skillsEl.classList.contains('hidden')) {
        document.body.classList.add('login-bg');
      } else {
        document.body.classList.remove('login-bg');
      }
    });
  </script>
</body>
</html>
